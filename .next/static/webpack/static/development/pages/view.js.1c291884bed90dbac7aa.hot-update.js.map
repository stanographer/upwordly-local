{"version":3,"file":"static/webpack/static/development/pages/view.js.1c291884bed90dbac7aa.hot-update.js","sources":["webpack:///./components/LiveTranscript/index.jsx"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport ShareDB from '@teamwork/sharedb/lib/client';\nimport ReconnectingWebSocket from 'reconnecting-websocket';\nimport WS from 'isomorphic-ws';\nimport otText from 'ot-text';\n\n// Components.\nimport { ButtonGroup, Nav } from '../../components/Controls';\n\nclass LiveTranscript extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = {\n      connection: {},\n      doc: {},\n      flag: 'â‰ˆ',\n      loading: true,\n    };\n  }\n\n  fetchDoc = (host) => {\n    const server = {\n      host: process.env.REACT_APP_ENV === 'production' ? 'upword.ly/ws' : host,\n      port: process.env.REACT_APP_ENV === 'production' ? '' : ':9090',\n      protocol: process.env.REACT_APP_ENV === 'production' ? 'wss://' : 'ws://',\n      getAddress: function () {\n        console.log(this.protocol + this.host + this.port);\n        return this.protocol + this.host + this.port;\n      },\n    };\n\n    const socket = new ReconnectingWebSocket(server.getAddress(), [], {\n      WebSocket: WS,\n      automaticOpen: true,\n      maxReconnectionDelay: 2000,\n      reconnectInterval: 2000,\n      maxReconnectInterval: 3000,\n      timeoutInterval: 2000,\n      maxRetries: Infinity,\n    });\n\n    ShareDB.types.register(otText.type);\n\n    const connection = new ShareDB.Connection(socket);\n\n    this.setState({\n      connection,\n      doc: connection.get(this.props.user, this.props.job),\n      loading: false,\n    });\n  };\n\n  componentDidMount() {\n    this.fetchDoc(window.location.hostname);\n  }\n\n  render() {\n    const {loading} = this.state;\n\n    return (\n        <Fragment>\n          <Nav />\n          {\n            !loading\n                ? this.props.render(this.state)\n                : null\n          }\n        </Fragment>\n    );\n  }\n}\n\nexport default LiveTranscript;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAUA;AAEA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAvCA;AACA;AACA;AACA;AACA;AAJA;AAHA;AASA;AACA;;;AAiCA;AACA;AACA;;;AAEA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;;;;AA7DA;AACA;AA+DA;;;;;A","sourceRoot":""}